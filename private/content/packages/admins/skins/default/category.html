<%include inc/top.html%>
<div class="uk-width-8-10" style="background:#fff;padding:10px;border:1px dotted #000">
<table width="100%">
<tr>
  <td valign="top" style="border-top:1px dotted #CCC">
    <b>Добавить категорию</b>
  </td>
  <td style="border:1px dotted #CCC"><div>
      <form name="cat_new" method="post" action="/cgi-bin/index.cgi">
      <input type="hidden" name="action" value="category">
      <input type="hidden" name="pkg" value="content:admins">
      <input type="text" value="" name="category_name" style="width:99%">
      <input type="submit" name="add" value="добавить">
      </form>
  </div></td>
</tr>
<%loop $cats as $c%>
<tr>
  <td valign="top" style="border-top:1px dotted #CCC">
    <b><%$c.category_name%></b> (<%$c.text_id%>)
    <span class="links" cat_id="cat_<%$c.category_id%>" id="click_<%$c.category_id%>" style="cursor:pointer">[редактировать]</span>
  </td>
  <td style="border:1px dotted #CCC"><div style="display:none" id="cat_<%$c.category_id%>">
      <form name="cat_<%$c.category_id%>" method="post" action="/cgi-bin/index.cgi">
      <input type="hidden" name="action" value="category">
      <input type="hidden" name="pkg" value="content:admins">
      <input type="hidden" name="category_id" value="<%$c.category_id%>">
      <input type="text" value="<%$c.category_name%>" name="category_name" style="width:99%">
      <input type="reset" value="отменить"><input type="submit" name="save" value="сохранить"><input type="submit" catid="<%$c.category_id%>" class="delete_button" name="delete" value ="удалить">
      </form>
  </div>
  </td>
</tr>
<%/loop%>
</table>

</div>
<%include inc/bottom.html%>
<%include inc/jss.html%>
<%include inc/jsscommon.html%>
<script type="text/javascript">

  $('.delete_button').click(function(){
    return(confirm('Удалить ' + $(this).attr('catid') + '?'));
  });

  $('.links').click(function(){
    var cat_id = $(this).attr('cat_id');
    var status = $(this).attr('status');
    if(!status) {
      $('#' + cat_id).css('display', 'block');
      $('#__' + cat_id).css('display', 'none');
      $(this).html('[скрыть]');
      $(this).attr('status', 'o');
    }
    if(status) {
      $('#' + cat_id).css('display', 'none');
      $('#__' + cat_id).css('display', 'block');
      $(this).html('[редактировать]');
      $(this).attr('status', '');
    }
  });

//   <%if $trigger%>
//     $('#click_<%$trigger%>').trigger('click');
//     location.hash = "#click_<%$trigger%>";
//   <%/if%>
  
</script>
<%include inc/end.html%>


